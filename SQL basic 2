
--Display the employee first name, last name, and department name for all employees who have an A in their first name. Sample output shown below.

SELECT e.first_name, e.last_name, d.department_name 
FROM employees e
JOIN departments d ON e.department_id = d.department_id
WHERE e.first_name LIKE '%A%';

--2- Generate a report to display staff full names (combination of first and last names), jobs and department names. 
--Rename the column headings to “Full Name”, “Job Title”, and “Department Name”. 
--Order the report alphabetically by the last name. A snapshot of sample rows is given below:

SELECT e.first_name || ' ' || e.last_name AS "Full Name",
        j.job_id AS "Job Title",
        d.department_name AS "Department Name"
FROM employees e
JOIN departments d ON e.department_id = d.department_id
JOIN jobs j ON e.job_id = j.job_id
ORDER BY e.last_name;

SELECT
    e.First_name || ' ' || e.Last_name AS "Full Name",
    j.job_ID AS "Job Title",
    d.Department_Name AS "Department Name"
FROM
    employees e
JOIN
    jobs j ON e.Job_Id = j.Job_Id
JOIN
    departments d ON e.Department_Id = d.Department_Id
ORDER BY
    e.Last_name;

--3 Modify question 2 to display the full name, department name, salary, and the city of all employees who earn a salary greater than 12000. 
-- See sample output below.
 
SELECT
    e.First_name || ' ' || e.Last_name AS "Full Name",
    d.Department_Name AS "Department Name",
    e.Salary,
    l.City
FROM
    employees e
JOIN
    departments d ON e.Department_Id = d.Department_Id
JOIN
    locations l ON d.Location_Id = l.Location_Id
WHERE
    e.Salary > 12000;

--4 Generate a report to display the department details (department id, name, street address, postal code, city, state province 
--and region name)  of all departments that are in regions 1 (Europe) and 4 (Middle East and Africa). 
--A snapshot of sample rows is given below:

SELECT
    d.Department_ID,
    d.Department_Name,
    l.Street_Address,
    l.Postal_Code,
    l.City,
    l.State_Province,
    c.Region_ID
FROM
    departments d
JOIN
    locations l ON d.Location_Id = l.Location_Id
JOIN
    countries c ON l.Country_Id = c.Country_Id

WHERE
    c.region_Id IN (1, 4)
ORDER BY
    d.Department_ID;       
--5 Generate a report to display the full names (combination of first and last names), 
--email address (generated by concatenating email id with @MEGACORP.COM), department name, and 
--office address (combination of city and country) of all employees. 
--Sort the output by the last name. Rename the columns as shown in the column headings below.

SELECT
    First_name || ' ' || Last_name AS "Full Name",
    LOWER(SUBSTR(Email, 1, INSTR(Email, '@') - 1)) || '@megacorp.com' AS "Email",
    Department_Name AS "Department Name",
    City || ', ' || Country_Name AS "Full Address"
FROM
    employees e
JOIN
    departments d ON e.Department_Id = d.Department_Id
JOIN
    locations l ON d.Location_Id = l.Location_Id
JOIN
    countries c ON l.Country_Id = c.Country_Id
ORDER BY
    Last_name;

SELECT
    e.First_name || ' ' || e.Last_name AS "Full Name",
    e.Email || '@MEGACORP.COM' AS "Email",
    d.Department_Name AS "Department Name",
    l.City || ', ' || c.Country_Name AS "Full Address"
FROM
    employees e
JOIN
    departments d ON e.Department_Id = d.Department_Id
JOIN
    locations l ON d.Location_Id = l.Location_Id
JOIN
    countries c ON l.Country_Id = c.Country_Id
ORDER BY
    e.Last_name;
    
--6 Modify the previous question to generate a dynamic report that displays the employee details (as listed in (5) above) for a specific country 
--(i.e. the user should be prompted to enter a country name). Run the report by entering different countries 
--(for example, United Kingdom). Hint: use substitution variable (&)
SELECT
    e.First_name || ' ' || e.Last_name AS "Full Name",
    e.Email_ID || '@MEGACORP.COM' AS "Email",
    d.Department_Name AS "Department Name",
    l.City || ', ' || c.Country_Name AS "Full Address"
FROM
    employees e
JOIN
    departments d ON e.Department_Id = d.Department_Id
JOIN
    locations l ON d.Location_Id = l.Location_Id
JOIN
    countries c ON l.Country_Id = c.Country_Id
WHERE
    c.Country_Name = '&country_name'
ORDER BY
    e.Last_name;

--7Generate a report to display the full names and department names of all employees. 
--The report must also include all departments including those that currently do not have any
--employees assigned to them. Hint: Use Outer Join. A snapshot of sample rows is given below.

SELECT
    e.First_name || ' ' || e.Last_name AS "Full Name",
    d.Department_Name AS "Department Name"
FROM
    employees e
JOIN
    departments d ON e.Department_Id = d.Department_Id
WHERE
    d.Department_Id IS NOT NULL;

--8 Generate a report to display the employee name and employee number along with their
--manager’s name and manager number. Label the columns Employee Name, Employee #,
--Manager #, and Manager Name respectively. Hint: Use Self Join. A snapshot of sample rows is given below:

SELECT
    e1.First_name || ' ' || e1.Last_name AS "Employee Name",
    e1.Employee_ID AS "Employee #",
    e2.Employee_ID AS "Manager #",
    e2.First_name || ' ' || e2.Last_name AS "Manager Name"
FROM
    employees e1
JOIN
    employees e2 ON e1.Manager_ID = e2.Employee_ID
ORDER BY
    "Employee Name";
    
--9 Explain why the previous report generated the details of 106 only employees? (Note: there are a total of 107 employees in the employees table)     


--10 Modify question 9 to display all 107 staff members

SELECT
    e1.First_name || ' ' || e1.Last_name AS "Employee Name",
    e1.Employee_ID AS "Employee #",
    e2.Employee_ID AS "Manager #",
    e2.First_name || ' ' || e2.Last_name AS "Manager Name"
FROM
    employees e1
LEFT JOIN
    employees e2 ON e1.Manager_ID = e2.Employee_ID
ORDER BY
    "Employee Name";
